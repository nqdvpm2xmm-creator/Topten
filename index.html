<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Top Ten ‚Äì IPM secret</title>

<style>
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: #0f172a;
    color: white;
    margin: 0;
    padding: 20px;
  }

  h1, h2 {
    text-align: center;
  }

  input, button {
    width: 100%;
    padding: 15px;
    margin: 8px 0;
    font-size: 18px;
    border-radius: 10px;
    border: none;
  }

  input { background: #e5e7eb; }
  button { background: #2563eb; color: white; font-weight: bold; }

  .player {
    background: #1e293b;
    padding: 15px;
    margin: 10px 0;
    border-radius: 10px;
    text-align: center;
    font-size: 20px;
  }

  .hidden { display: none; }

  .ipm {
    font-size: 80px;
    font-weight: bold;
    text-align: center;
    margin: 40px 0;
  }

  .captain {
    background: #9333ea;
  }

  .warning {
    text-align: center;
    font-size: 14px;
    opacity: 0.8;
  }
</style>
</head>

<body>

<h1>üé≤ Top Ten</h1>

<div id="setup">
  <h2>Ajouter les joueurs</h2>
  <input type="text" id="playerInput" placeholder="Nom du joueur">
  <button onclick="addPlayer()">Ajouter</button>

  <h2>Choisir le Cap‚Äôten</h2>
  <div id="captainList"></div>

  <button onclick="startGame()">üéØ Lancer le tour</button>
</div>

<div id="selection" class="hidden">
  <h2>Clique sur ton pr√©nom</h2>
  <div id="playerButtons"></div>
</div>

<div id="reveal" class="hidden">
  <h2 id="revealTitle"></h2>
  <div class="ipm" id="ipmValue"></div>
  <button onclick="hideIPM()">J‚Äôai m√©moris√©</button>
  <p class="warning">‚ö†Ô∏è Ne montre pas l‚Äô√©cran</p>
</div>

<script>
let players = [];
let captain = null;
let assignments = {};

function addPlayer() {
  const input = document.getElementById("playerInput");
  const name = input.value.trim();
  if (!name) return;

  players.push(name);
  input.value = "";
  renderCaptainChoice();
}

function renderCaptainChoice() {
  const div = document.getElementById("captainList");
  div.innerHTML = "";

  players.forEach(p => {
    const btn = document.createElement("button");
    btn.textContent = p;
    btn.onclick = () => selectCaptain(p);
    if (p === captain) btn.classList.add("captain");
    div.appendChild(btn);
  });
}

function selectCaptain(name) {
  captain = name;
  renderCaptainChoice();
}

function startGame() {
  if (!captain || players.length < 3) return;

  const others = players.filter(p => p !== captain);
  const numbers = Array.from({ length: others.length }, (_, i) => i + 1);

  for (let i = numbers.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [numbers[i], numbers[j]] = [numbers[j], numbers[i]];
  }

  assignments = {};
  others.forEach((p, i) => assignments[p] = numbers[i]);
  assignments[captain] = null;

  document.getElementById("setup").classList.add("hidden");
  showSelection();
}

function showSelection() {
  document.getElementById("selection").classList.remove("hidden");
  document.getElementById("reveal").classList.add("hidden");

  const div = document.getElementById("playerButtons");
  div.innerHTML = "";

  players.forEach(p => {
    const btn = document.createElement("button");
    btn.textContent = p;
    btn.onclick = () => showIPM(p);
    div.appendChild(btn);
  });
}

function showIPM(player) {
  document.getElementById("selection").classList.add("hidden");
  document.getElementById("reveal").classList.remove("hidden");

  if (player === captain) {
    document.getElementById("revealTitle").textContent = "Tu es le Cap‚Äôten üëë";
    document.getElementById("ipmValue").textContent = "‚Äî";
  } else {
    document.getElementById("revealTitle").textContent = "Ton IPM";
    document.getElementById("ipmValue").textContent = assignments[player];
  }
}

function hideIPM() {
  showSelection();
}
</script>

</body>
</html>
